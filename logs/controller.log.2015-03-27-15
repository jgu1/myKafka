[2015-03-27 16:00:09,504] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-03-27 16:00:09,506] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-03-27 16:00:09,506] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-03-27 16:00:09,506] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-03-27 16:03:25,660] INFO [Controller 2]: Controller starting up (kafka.controller.KafkaController)
[2015-03-27 16:03:25,695] INFO [Controller 2]: Controller startup complete (kafka.controller.KafkaController)
[2015-03-27 16:03:25,752] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 2,1,0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-03-27 16:03:25,800] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 2, deleted brokers: , all live brokers: 2,1,0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-03-27 16:03:25,801] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2015-03-27 16:03:25,804] INFO [Controller-0-to-broker-2-send-thread], Controller 0 connected to id:2,host:airbears2-10-142-35-31.airbears2.1918.berkeley.edu,port:9094 for sending state change requests (kafka.controller.RequestSendThread)
[2015-03-27 16:03:25,804] INFO [Controller 0]: New broker startup callback for 2 (kafka.controller.KafkaController)
[2015-03-27 16:03:25,804] INFO [Controller-0-to-broker-2-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-03-27 16:03:53,449] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@365aad2a, name=log4j:logger=kafka.controller (kafka.controller)
[2015-03-27 16:03:57,994] INFO [Controller 0]: Shutting down broker 0 (kafka.controller.KafkaController)
[2015-03-27 16:03:57,995] DEBUG [Controller 0]: All shutting down brokers: 0 (kafka.controller.KafkaController)
[2015-03-27 16:03:57,996] DEBUG [Controller 0]: Live brokers: 2,1 (kafka.controller.KafkaController)
[2015-03-27 16:03:58,004] TRACE [Controller 0]: All leaders = [test,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1) (kafka.controller.KafkaController)
[2015-03-27 16:03:58,894] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2015-03-27 16:03:58,895] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2015-03-27 16:03:58,896] INFO [Controller-0-to-broker-2-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-03-27 16:03:58,896] INFO [Controller-0-to-broker-2-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-03-27 16:03:58,896] INFO [Controller-0-to-broker-2-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-03-27 16:03:58,896] INFO [Controller-0-to-broker-1-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-03-27 16:03:58,896] INFO [Controller-0-to-broker-1-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-03-27 16:03:58,896] INFO [Controller-0-to-broker-1-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-03-27 16:03:58,897] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-03-27 16:03:58,897] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-03-27 16:03:58,897] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-03-27 16:03:58,897] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2015-03-27 16:03:58,930] INFO [Controller 2]: Broker 2 starting become controller state transition (kafka.controller.KafkaController)
[2015-03-27 16:03:58,933] INFO [Controller 2]: Initialized controller epoch to 1 and zk version 0 (kafka.controller.KafkaController)
[2015-03-27 16:03:58,943] INFO [Controller 2]: Controller 2 incremented epoch to 2 (kafka.controller.KafkaController)
[2015-03-27 16:03:59,069] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2015-03-27 16:03:59,079] INFO [Controller-2-to-broker-1-send-thread], Controller 2 connected to id:1,host:airbears2-10-142-35-31.airbears2.1918.berkeley.edu,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-03-27 16:03:59,080] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2015-03-27 16:03:59,081] INFO [Controller-2-to-broker-2-send-thread], Controller 2 connected to id:2,host:airbears2-10-142-35-31.airbears2.1918.berkeley.edu,port:9094 for sending state change requests (kafka.controller.RequestSendThread)
[2015-03-27 16:03:59,081] INFO [Controller-2-to-broker-2-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-03-27 16:03:59,081] INFO [Controller-2-to-broker-1-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-03-27 16:03:59,084] INFO [Controller 2]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-03-27 16:03:59,084] INFO [Controller 2]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-03-27 16:03:59,085] INFO [Controller 2]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-03-27 16:03:59,089] INFO [Controller 2]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-03-27 16:03:59,089] INFO [Controller 2]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-03-27 16:03:59,090] INFO [Controller 2]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-03-27 16:03:59,095] INFO [Controller 2]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-03-27 16:03:59,096] INFO [Controller 2]: List of topics ineligible for deletion: test (kafka.controller.KafkaController)
[2015-03-27 16:03:59,100] INFO [Controller 2]: Currently active brokers in the cluster: Set(1, 2) (kafka.controller.KafkaController)
[2015-03-27 16:03:59,100] INFO [Controller 2]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-03-27 16:03:59,101] INFO [Controller 2]: Current list of topics in the cluster: Set(test) (kafka.controller.KafkaController)
[2015-03-27 16:03:59,109] INFO [Replica state machine on controller 2]: Started replica state machine with initial state -> Map([Topic=test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-03-27 16:03:59,138] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-03-27 16:03:59,144] INFO [Partition state machine on Controller 2]: Started partition state machine with initial state -> Map([test,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-03-27 16:03:59,147] INFO [Controller 2]: Broker 2 is ready to serve as the new controller with epoch 2 (kafka.controller.KafkaController)
[2015-03-27 16:03:59,149] INFO [Controller 2]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-03-27 16:03:59,151] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-03-27 16:03:59,161] INFO [Controller 2]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-03-27 16:04:02,346] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2015-03-27 16:04:02,383] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2015-03-27 16:04:02,429] INFO [BrokerChangeListener on Controller 2]: Broker change listener fired for path /brokers/ids with children 2,1,0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-03-27 16:04:02,490] INFO [BrokerChangeListener on Controller 2]: Newly added brokers: 0, deleted brokers: , all live brokers: 2,1,0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-03-27 16:04:02,491] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-03-27 16:04:02,492] INFO [Controller-2-to-broker-0-send-thread], Controller 2 connected to id:0,host:airbears2-10-142-35-31.airbears2.1918.berkeley.edu,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-03-27 16:04:02,493] INFO [Controller-2-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-03-27 16:04:02,494] INFO [Controller 2]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2015-03-27 16:04:02,496] INFO [Replica state machine on controller 2]: Invoking state change to OnlineReplica for replicas [Topic=test,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-03-27 16:04:02,536] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-03-27 16:04:02,537] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":1,"isr":[0]} for offline partition [test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-03-27 16:04:02,547] DEBUG [Partition state machine on Controller 2]: After leader election, leader cache is updated to Map([test,0] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:2)) (kafka.controller.PartitionStateMachine)
[2015-03-27 16:04:04,168] TRACE [Controller 2]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-03-27 16:04:04,173] DEBUG [Controller 2]: preferred replicas by broker Map(0 -> Map([test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-03-27 16:04:04,175] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-03-27 16:04:04,177] TRACE [Controller 2]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-03-27 16:04:41,641] INFO [Controller 2]: Shutting down broker 0 (kafka.controller.KafkaController)
[2015-03-27 16:04:41,642] DEBUG [Controller 2]: All shutting down brokers: 0 (kafka.controller.KafkaController)
[2015-03-27 16:04:41,642] DEBUG [Controller 2]: Live brokers: 2,1 (kafka.controller.KafkaController)
[2015-03-27 16:04:41,647] TRACE [Controller 2]: All leaders = [test,0] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:2) (kafka.controller.KafkaController)
[2015-03-27 16:04:42,374] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2015-03-27 16:04:42,374] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2015-03-27 16:04:42,375] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2015-03-27 16:04:42,388] INFO [BrokerChangeListener on Controller 2]: Broker change listener fired for path /brokers/ids with children 2,1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-03-27 16:04:42,402] INFO [BrokerChangeListener on Controller 2]: Newly added brokers: , deleted brokers: 0, all live brokers: 2,1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-03-27 16:04:42,404] INFO [Controller-2-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-03-27 16:04:42,404] INFO [Controller-2-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-03-27 16:04:42,404] INFO [Controller-2-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-03-27 16:04:42,405] INFO [Controller 2]: Broker failure callback for 0 (kafka.controller.KafkaController)
[2015-03-27 16:04:42,406] INFO [Controller 2]: Removed ArrayBuffer(0) from list of shutting down brokers. (kafka.controller.KafkaController)
[2015-03-27 16:04:42,407] INFO [Partition state machine on Controller 2]: Invoking state change to OfflinePartition for partitions [test,0] (kafka.controller.PartitionStateMachine)
[2015-03-27 16:04:42,416] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-03-27 16:04:42,420] INFO [Replica state machine on controller 2]: Invoking state change to OfflineReplica for replicas [Topic=test,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-03-27 16:04:42,424] DEBUG [Controller 2]: Removing replica 0 from ISR 0 for partition [test,0]. (kafka.controller.KafkaController)
[2015-03-27 16:04:42,439] INFO [Controller 2]: New leader and ISR for partition [test,0] is {"leader":-1,"leader_epoch":2,"isr":[]} (kafka.controller.KafkaController)
[2015-03-27 16:04:42,444] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-03-27 16:04:42,444] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=test,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-03-27 16:04:42,448] WARN [Channel manager on controller 2]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 8; ClientId: ; DeletePartitions: false; ControllerId: 2; ControllerEpoch: 2; Partitions: [test,0] to broker 0, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-03-27 16:06:07,827] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2d247c45, name=log4j:logger=kafka.controller (kafka.controller)
[2015-03-27 16:06:08,658] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2015-03-27 16:06:08,688] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2015-03-27 16:06:09,256] INFO [Controller 2]: Shutting down broker 1 (kafka.controller.KafkaController)
[2015-03-27 16:06:09,256] DEBUG [Controller 2]: All shutting down brokers: 1 (kafka.controller.KafkaController)
[2015-03-27 16:06:09,256] DEBUG [Controller 2]: Live brokers: 2 (kafka.controller.KafkaController)
[2015-03-27 16:06:09,256] TRACE [Controller 2]: All leaders = [test,0] -> (Leader:-1,ISR:,LeaderEpoch:2,ControllerEpoch:2) (kafka.controller.KafkaController)
[2015-03-27 16:06:09,812] INFO [BrokerChangeListener on Controller 2]: Broker change listener fired for path /brokers/ids with children 2,1,0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-03-27 16:06:09,846] INFO [BrokerChangeListener on Controller 2]: Newly added brokers: 0, deleted brokers: , all live brokers: 2,0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-03-27 16:06:09,846] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-03-27 16:06:09,847] INFO [Controller-2-to-broker-0-send-thread], Controller 2 connected to id:0,host:airbears2-10-142-35-31.airbears2.1918.berkeley.edu,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-03-27 16:06:09,847] INFO [Controller 2]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2015-03-27 16:06:09,848] INFO [Replica state machine on controller 2]: Invoking state change to OnlineReplica for replicas [Topic=test,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-03-27 16:06:09,849] INFO [Controller-2-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-03-27 16:06:09,853] WARN [Controller-2-to-broker-1-send-thread], Controller 2 epoch 2 fails to send request Name:UpdateMetadataRequest;Version:0;Controller:2;ControllerEpoch:2;CorrelationId:10;ClientId:id_2-host_-port_9094;AliveBrokers:id:2,host:airbears2-10-142-35-31.airbears2.1918.berkeley.edu,port:9094,id:1,host:airbears2-10-142-35-31.airbears2.1918.berkeley.edu,port:9093,id:0,host:airbears2-10-142-35-31.airbears2.1918.berkeley.edu,port:9092;PartitionState:[test,0] -> (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:2,ControllerEpoch:2),ReplicationFactor:1),AllReplicas:0) to broker id:1,host:airbears2-10-142-35-31.airbears2.1918.berkeley.edu,port:9093. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:197)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:379)
	at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:212)
	at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	at kafka.utils.Utils$.read(Utils.scala:380)
	at kafka.network.BoundedByteBufferReceive.readFrom(BoundedByteBufferReceive.scala:54)
	at kafka.network.Receive$class.readCompletely(Transmission.scala:56)
	at kafka.network.BoundedByteBufferReceive.readCompletely(BoundedByteBufferReceive.scala:29)
	at kafka.network.BlockingChannel.receive(BlockingChannel.scala:111)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:133)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-03-27 16:06:09,855] INFO [Controller-2-to-broker-1-send-thread], Controller 2 connected to id:1,host:airbears2-10-142-35-31.airbears2.1918.berkeley.edu,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-03-27 16:06:09,864] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [test,0]. Pick the leader from the alive assigned replicas: 0 (kafka.controller.OfflinePartitionLeaderSelector)
[2015-03-27 16:06:09,865] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [test,0]. Elect leader 0 from live brokers 0. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-03-27 16:06:09,866] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":3,"isr":[0]} for offline partition [test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-03-27 16:06:09,870] DEBUG [Partition state machine on Controller 2]: After leader election, leader cache is updated to Map([test,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:2)) (kafka.controller.PartitionStateMachine)
[2015-03-27 16:06:09,872] INFO [Controller 2]: Shutting down broker 2 (kafka.controller.KafkaController)
[2015-03-27 16:06:09,872] DEBUG [Controller 2]: All shutting down brokers: 1,2 (kafka.controller.KafkaController)
[2015-03-27 16:06:09,872] DEBUG [Controller 2]: Live brokers: 0 (kafka.controller.KafkaController)
[2015-03-27 16:06:09,873] TRACE [Controller 2]: All leaders = [test,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:2) (kafka.controller.KafkaController)
[2015-03-27 16:06:10,137] INFO [BrokerChangeListener on Controller 2]: Broker change listener fired for path /brokers/ids with children 2,0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-03-27 16:06:10,149] INFO [BrokerChangeListener on Controller 2]: Newly added brokers: , deleted brokers: 1, all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-03-27 16:06:10,149] INFO [Controller-2-to-broker-1-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-03-27 16:06:10,149] INFO [Controller-2-to-broker-1-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-03-27 16:06:10,149] INFO [Controller-2-to-broker-1-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-03-27 16:06:10,149] INFO [Controller 2]: Broker failure callback for 1 (kafka.controller.KafkaController)
[2015-03-27 16:06:10,150] INFO [Controller 2]: Removed ArrayBuffer(1) from list of shutting down brokers. (kafka.controller.KafkaController)
[2015-03-27 16:06:10,150] INFO [Partition state machine on Controller 2]: Invoking state change to OfflinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-03-27 16:06:10,610] INFO [Partition state machine on Controller 2]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2015-03-27 16:06:10,611] INFO [Replica state machine on controller 2]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2015-03-27 16:06:10,611] INFO [Controller-2-to-broker-2-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-03-27 16:06:10,611] INFO [Controller-2-to-broker-2-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-03-27 16:06:10,612] INFO [Controller-2-to-broker-2-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-03-27 16:06:10,612] INFO [Controller-2-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-03-27 16:06:10,612] INFO [Controller-2-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-03-27 16:06:10,612] INFO [Controller-2-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-03-27 16:06:10,613] INFO [Controller 2]: Broker 2 resigned as the controller (kafka.controller.KafkaController)
[2015-03-27 16:06:10,632] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2015-03-27 16:06:10,634] INFO [Controller 0]: Initialized controller epoch to 2 and zk version 1 (kafka.controller.KafkaController)
[2015-03-27 16:06:10,638] INFO [Controller 0]: Controller 0 incremented epoch to 3 (kafka.controller.KafkaController)
[2015-03-27 16:06:10,723] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-03-27 16:06:10,728] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:airbears2-10-142-35-31.airbears2.1918.berkeley.edu,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-03-27 16:06:10,730] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-03-27 16:06:10,732] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-03-27 16:06:10,732] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-03-27 16:06:10,733] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-03-27 16:06:10,735] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-03-27 16:06:10,736] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-03-27 16:06:10,737] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-03-27 16:06:10,742] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-03-27 16:06:10,742] INFO [Controller 0]: List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2015-03-27 16:06:10,744] INFO [Controller 0]: Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2015-03-27 16:06:10,745] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-03-27 16:06:10,746] INFO [Controller 0]: Current list of topics in the cluster: Set(test) (kafka.controller.KafkaController)
[2015-03-27 16:06:10,752] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=test,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-03-27 16:06:10,765] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=test,Partition=0,Replica=0] -> OnlineReplica) (kafka.controller.ReplicaStateMachine)
[2015-03-27 16:06:10,771] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([test,0] -> OnlinePartition) (kafka.controller.PartitionStateMachine)
[2015-03-27 16:06:10,773] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 3 (kafka.controller.KafkaController)
[2015-03-27 16:06:10,775] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-03-27 16:06:10,776] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-03-27 16:06:10,780] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-03-27 16:06:15,788] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-03-27 16:06:15,792] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-03-27 16:06:15,794] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-03-27 16:06:15,796] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-03-27 16:11:15,793] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-03-27 16:11:15,793] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-03-27 16:11:15,793] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-03-27 16:11:15,793] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-03-27 16:16:15,798] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-03-27 16:16:15,800] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-03-27 16:16:15,800] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-03-27 16:16:15,801] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-03-27 16:21:15,796] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-03-27 16:21:15,798] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-03-27 16:21:15,798] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-03-27 16:21:15,798] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
